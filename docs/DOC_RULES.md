# Alpha-Trade 文档规范 (Documentation Rules)

**状态**: 强制执行  
**适用**: AI Assistant 及所有贡献者

---

## 1. 核心原则

### 1.1 简洁优先 (Brevity First)
- **禁止冗长啰嗦**：文档应直击要点，避免重复说明
- **示例优于长篇**：用代码示例代替大段文字解释
- **表格优于段落**：结构化数据用表格展示

### 1.2 单一真理来源 (Single Source of Truth)
- **禁止重复文档**：同一信息只在一处记录
- **引用优于复制**：需要相同内容时使用链接引用
- **明确文档优先级**：
  - `DEVELOPMENT_MANUAL.md` = 架构真理
  - `RISK_PROTOCOL.md` = 风控真理
  - `SECURITY_PROTOCOL.md` = 安全真理

### 1.3 及时归档 (Archive Promptly)
- **历史文档立即归档**：Phase 完成后立即移至 `docs/archive/`
- **禁止累积临时文档**：避免创建 `TEMP_`, `OLD_`, `BACKUP_` 前缀文档
- **Summary 文档生命周期**：完成当天归档

---

## 2. 文档分类与存放

### 2.1 根目录 (`/`)
**仅允许以下文档**：
- `README.md` - 项目入口（状态、快速开始、文档索引）
- `NEXT_STEPS.md` - 当前周期任务（本周 + 下周）

**严格限制**：
- ❌ 禁止创建 `STATUS.md`, `PROGRESS.md`, `TODO.md`（已包含在 NEXT_STEPS.md）
- ❌ 禁止创建任何 `*_SUMMARY.md`（归档到 docs/archive/）

### 2.2 核心文档 (`docs/`)
**永久文档**：
- `DEVELOPMENT_MANUAL.md` - 架构设计、领域模型、工程规范
- `RISK_PROTOCOL.md` - 风控协议
- `SECURITY_PROTOCOL.md` - 安全协议
- `ROADMAP.md` - 项目路线图
- `architecture_flow.md` - 架构流程图
- `README.md` - 文档中心导航

**业务文档**：
- `ADMIN_UI_PROTOTYPE.md` - 管理后台设计

### 2.3 规划文档 (`docs/plans/`)
**Phase 计划**：
- `PHASE_N_DETAIL.md` - 详细执行计划
- `PHASE_N_EXEC_PLAN.md` - 执行指南
- 特殊迁移计划（如 `MIGRATION_TO_CREWAI.md`）

### 2.4 历史归档 (`docs/archive/`)
**归档标准**：
- Phase 完成总结（`PHASE_N_SUMMARY.md`）
- 问题修复记录（`FIXES_SUMMARY.md`）
- 废弃的设计方案

**归档时机**：
- Phase 完成后立即归档
- 每周清理一次临时文档

### 2.5 子系统文档
- `ai-agent/README.md` + `ai-agent/prompt/`
- `docs/auth/` - 认证模块专项文档

---

## 3. 文档编写规范

### 3.1 标题与结构
```markdown
# 文档标题

**状态**: 草稿/执行中/已完成/已归档  
**更新时间**: YYYY-MM-DD  
**负责人**: [可选]

---

## 1. 核心内容
...

## 2. 详细说明
...

---

**最后更新**: YYYY-MM-DD
```

### 3.2 代码块规范
- **命令行**：使用 `bash` 标记
- **代码示例**：必须指定语言（`go`, `python`, `sql`）
- **配置文件**：使用实际格式（`yaml`, `json`, `env`）
- **伪代码**：使用注释说明 `// 伪代码示例`

### 3.3 禁止内容
- ❌ 禁止编写 Example 代码示例章节（除非特别复杂）
- ❌ 禁止啰嗦的前言、背景、总结
- ❌ 禁止大段引用外部文档（用链接）
- ❌ 禁止过时的时间戳（更新文档必须更新时间）

### 3.4 链接规范
- **相对路径**：同仓库文档使用相对路径
  - 正确：`[风控协议](RISK_PROTOCOL.md)`
  - 错误：`[风控协议](/Users/x/dev/work/alpha-trade/docs/RISK_PROTOCOL.md)`
- **外部链接**：必须完整 URL
- **锚点链接**：用于长文档内部跳转

---

## 4. 文档维护流程

### 4.1 创建新文档
**必须评估**：
1. 是否可合并到现有文档？
2. 是否属于临时记录（应使用 TODO/Issue）？
3. 存放位置是否符合分类规则？

**审批标准**：
- 核心文档（`docs/`）：必须是永久有效的架构/协议
- 规划文档（`docs/plans/`）：必须是完整的 Phase 计划
- 临时文档：禁止创建，使用代码注释或 Issue

### 4.2 更新文档
**强制要求**：
- 更新 `**更新时间**` 字段
- 修改重大内容需在文档末尾添加 `## 修订历史`

### 4.3 删除与归档
**删除条件**：
- 内容已完全过时
- 职责已被其他文档覆盖
- 属于错误归属（如其他项目文档）

**归档条件**：
- Phase 已完成
- 问题已修复且记录完整
- 设计方案已废弃但有参考价值

**执行**：
```bash
# 归档示例
mv PHASE_3_SUMMARY.md docs/archive/
git commit -m "docs: archive Phase 3 summary"
```

---

## 5. AI 助手执行指令

### 5.1 文档整理任务
当用户要求"整理文档"时，执行以下步骤：

1. **扫描冗余**：
   - 查找重复职责文档（如多个 STATUS/PROGRESS）
   - 识别错误归属文档（检查文件内容提及的路径）
   - 发现过时的 Summary 文档

2. **分类处理**：
   - 删除：错误归属、完全重复
   - 合并：职责重叠但内容互补
   - 归档：已完成的 Phase 总结

3. **结构优化**：
   - 简化过长文档（如 NEXT_STEPS.md > 100 行）
   - 创建缺失的索引（README.md）
   - 统一命名风格

4. **生成报告**：
   - 创建 `.doc-cleanup-summary.md`
   - 列出所有变更和理由

### 5.2 创建文档任务
当用户要求"创建 XXX 文档"时，先询问：

```
检测到创建文档请求。确认以下信息：

1. 文档类型：核心/规划/临时？
2. 存放位置：根目录/docs/docs/plans？
3. 是否可合并到现有文档？

建议：[根据内容给出存放建议]
```

### 5.3 更新文档任务
自动执行：
- 更新时间戳
- 保持格式一致
- 检查链接有效性

---

## 6. 文档质量检查清单

### 6.1 提交前自查
- [ ] 文档标题清晰
- [ ] 更新时间正确
- [ ] 无冗余重复内容
- [ ] 代码块有语言标记
- [ ] 链接使用相对路径
- [ ] 存放位置符合规范

### 6.2 定期审查（每 Phase 结束）
- [ ] 归档已完成的 Summary
- [ ] 删除临时文档
- [ ] 更新 README.md 索引
- [ ] 检查文档数量（< 25 个为健康状态）

---

## 7. 反模式 (Anti-Patterns)

### ❌ 禁止的做法
1. **文档堆积症**：创建大量未归档的临时文档
2. **复制粘贴**：在多个文档重复相同内容
3. **过度设计**：为简单事项创建复杂文档
4. **标题党**：文档名称与内容不符
5. **僵尸文档**：长期不更新的过时文档

### ✅ 推荐的做法
1. **及时归档**：Phase 完成立即整理
2. **引用链接**：相同内容用链接关联
3. **精简原则**：能用表格不用段落
4. **明确命名**：文档名称准确反映内容
5. **定期清理**：每周检查文档健康度

---

## 8. 示例对比

### ❌ 错误示例
```
项目根目录/
├── README.md
├── STATUS.md              # 与 README 重复
├── PROGRESS.md            # 与 README 重复
├── TODO.md                # 应该在 NEXT_STEPS.md
├── NEXT_STEPS.md
├── NEXT_STEPS_OLD.md      # 应该删除或归档
├── PHASE_3_SUMMARY.md     # 应该在 archive/
├── TEMP_NOTES.md          # 临时文档应删除
└── docs/
    ├── NEXT_STEPS.md      # 与根目录重复
    └── STATUS_2026.md     # 与根目录重复
```

### ✅ 正确示例
```
项目根目录/
├── README.md              # 唯一入口
├── NEXT_STEPS.md          # 唯一任务文档
└── docs/
    ├── README.md          # 文档中心
    ├── DEVELOPMENT_MANUAL.md
    ├── RISK_PROTOCOL.md
    ├── SECURITY_PROTOCOL.md
    ├── archive/           # 历史归档
    │   ├── PHASE_2_SUMMARY.md
    │   └── PHASE_3_SUMMARY.md
    └── plans/
        └── PHASE_4_DETAIL.md
```

---

## 9. 文档健康度指标

### 健康标准
- **文档总数**: < 25 个（不含 venv/node_modules）
- **根目录文档**: ≤ 2 个（README.md + NEXT_STEPS.md）
- **Summary 未归档**: 0 个
- **重复职责文档**: 0 个

### 警报阈值
- 🟡 文档总数 25-30：需要清理
- 🔴 文档总数 > 30：严重混乱
- 🔴 根目录 > 5 个：立即整理

---

## 执行

**AI 助手必须**：
1. 严格遵守本规范
2. 主动发现违规文档
3. 每次文档操作后自查
4. 定期提醒用户整理

**贡献者应当**：
1. 创建文档前阅读本规范
2. 遵循文档分类规则
3. 及时归档完成的内容

---

**本文档状态**: 执行中  
**最后更新**: 2026-01-22
