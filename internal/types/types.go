// Code generated by goctl. DO NOT EDIT.
// goctl 1.9.2

package types

type AddBeginRequest struct {
	Label string `json:"label"` // 硬件设备备注名 (e.g. YubiKey 5C, MacBook TouchID)
}

type AddBeginResponse struct {
	Options string `json:"options"` // 序列化后的 PublicKeyCredentialCreationOptions
}

type AddFinishRequest struct {
	Response string `json:"response"` // 浏览器返回的 PublicKeyCredential
}

type AddFinishResponse struct {
	Success bool `json:"success"`
}

type CredentialItem struct {
	Id         int64  `json:"id"`
	Label      string `json:"label"`
	Aaguid     string `json:"aaguid"`
	LastUsedAt int64  `json:"lastUsedAt"`
	CreatedAt  int64  `json:"createdAt"`
}

type ListResponse struct {
	List []CredentialItem `json:"list"`
}

type LoginRequest struct {
	Username string `json:"username"`
	Password string `json:"password"`
}

type LoginResponse struct {
	Status       string   `json:"status"`                // "success", "require_mfa"
	PendingToken string   `json:"pendingToken,optional"` // [短效 5min] 用于 MFA 挑战的临时凭证
	MfaType      string   `json:"mfaType,optional"`      // "passkey", "totp"
	Token        string   `json:"token,optional"`        // [常规 24h] 全权限 JWT
	User         UserInfo `json:"user,optional"`         // 用户基础信息
}

type LogoutResponse struct {
	Success bool `json:"success"`
}

type OAuth2CallbackResponse struct {
	Code  string `json:"code"`
	State string `json:"state"`
}

type OAuth2InitResponse struct {
	RedirectURL string `json:"redirectUrl"`
}

type OAuth2Request struct {
	Provider string `json:"provider"` // "google", "github"
}

type RemoveRequest struct {
	Id int64 `json:"id"`
}

type SystemInfoReq struct {
}

type SystemInfoResp struct {
	Version    string `json:"version"`     // 版本号
	BuildTime  string `json:"build_time"`  // 构建时间
	CommitHash string `json:"commit_hash"` // 提交哈希
}

type UserInfo struct {
	Id          int64  `json:"id"`
	Username    string `json:"username"`
	DisplayName string `json:"displayName"`
	Avatar      string `json:"avatar"`
}

type VerifyBeginRequest struct {
	Action string `json:"action,optional"` // 触发验证的行为类型 (e.g. "2fa", "withdraw", "update_risk")
}

type VerifyBeginResponse struct {
	Options string `json:"options"` // 序列化后的 PublicKeyCredentialRequestOptions
}

type VerifyFinishRequest struct {
	Response string `json:"response"` // 浏览器返回的 AuthenticatorAssertionResponse
}

type VerifyFinishResponse struct {
	VerifiedToken string `json:"verifiedToken"` // 验证成功后的短期令牌，用于执行受保护的操作
}
